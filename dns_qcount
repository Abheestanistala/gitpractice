q=$(grep -iho "info queries" var/log/messages* | head -1 | awk '{print $2}')
if [ "$q" == "" ]; then grep -iho 'info client.*' var/log/messages* | awk -F'client|#' '{print $2}' | sort | uniq -c | sort -nr | head -20 > topclientqueries ; echo " Query count per IP" ; echo "----------------------";cat topclientqueries ;echo -e '\n'; awk '{print $2}' topclientqueries > topqueryIP ; for line in $(cat topqueryIP); do  echo -e " Zones queried by $line";echo "------------------------------------"; grep -iho 'info client.*' var/log/messages* | grep -w "$line"|grep -o 'query:.*' | awk '{print $2}'| sort | uniq -c | sort -nr | head -10;echo -e '\n' ; done ;rm -rf top*; else grep -io 'info queries.*' var/log/messages* | awk -F'client|#' '{print $2}' | sort | uniq -c | sort -nr | head -20 > topclientqueries ;echo " Query count per IP" ;echo "----------------------";cat topclientqueries ;echo -e '\n';awk '{print $2}' topclientqueries > topqueryIP ;for line in $(cat topqueryIP);do  echo -e " Zones queried by $line";echo "------------------------------------";grep -iho 'info queries.*' var/log/messages* | grep -w "$line"|grep -o 'query:.*' | awk '{print $2}'| sort | uniq -c | sort -nr | head -10;echo -e '\n' ;done ;rm -rf top* ;fi
